<app-header></app-header>

<div class="top_container sub_pages">
    <section class="hero_section">
        <div class="hero-container container">
            <div class="hero_detail-box">
                <h1>Cadastro de Usu√°rio</h1>
                <p>Criar novo login para o sistema</p>
            </div>
        </div>
    </section>
</div>

<section class="cadastro_section layout_padding">
    <div class="container">
        <div class="row">
            <div class="col-md-8 mx-auto">
                <div class="cadastro-form">

                    <!-- Toast de Sucesso -->
                    @if (showToast()) {
                        <div class="alert alert-success alert-dismissible fade show" role="alert">
                            <strong>‚úÖ Sucesso!</strong> {{ toastMessage() }}
                        </div>
                    }

                    <!-- Mensagem de erro -->
                    @if (errorMessage()) {
                        <div class="alert alert-danger" role="alert">
                            {{ errorMessage() }}
                        </div>
                    }

                    <form (ngSubmit)="onSubmit()" #cadastroForm="ngForm">
                        <!-- Nome Completo -->
                        <div class="form-group">
                            <label for="nome_completo">Nome Completo *</label>
                            <input 
                                type="text" 
                                id="nome_completo"
                                [(ngModel)]="formData.nome_completo" 
                                name="nome_completo" 
                                placeholder="Digite o nome completo" 
                                required
                                minlength="3"
                                [disabled]="isLoading()"
                                class="form-control">
                            <small class="form-text text-muted">M√≠nimo 3 caracteres</small>
                        </div>

                        <!-- E-mail -->
                        <div class="form-group">
                            <label for="email">E-mail *</label>
                            <input 
                                type="email" 
                                id="email"
                                [(ngModel)]="formData.email" 
                                name="email" 
                                placeholder="usuario@exemplo.com" 
                                required
                                email
                                [disabled]="isLoading()"
                                class="form-control">
                            <small class="form-text text-muted">Ser√° usado para fazer login</small>
                        </div>

                        <!-- Perfil -->
                        <div class="form-group">
                            <label for="perfil">Perfil *</label>
                            <select 
                                id="perfil"
                                [(ngModel)]="formData.perfil" 
                                name="perfil" 
                                required
                                [disabled]="isLoading()"
                                class="form-control">
                                @for (perfil of perfis; track perfil.value) {
                                    <option [value]="perfil.value">{{ perfil.label }}</option>
                                }
                            </select>
                            <small class="form-text text-muted">Define as permiss√µes do usu√°rio</small>
                        </div>

                        <!-- Senha -->
                        <div class="form-group">
                            <label for="senha">Senha *</label>
                            <div class="input-group">
                                <input 
                                    [type]="showPassword() ? 'text' : 'password'"
                                    id="senha"
                                    [(ngModel)]="formData.senha" 
                                    name="senha" 
                                    placeholder="M√≠nimo 6 caracteres"
                                    required
                                    minlength="6"
                                    [disabled]="isLoading()"
                                    class="form-control">
                                <button 
                                    type="button"
                                    class="btn btn-outline-secondary"
                                    (click)="togglePasswordVisibility()"
                                    [disabled]="isLoading()">
                                    {{ showPassword() ? 'üëÅÔ∏è' : 'üëÅÔ∏è‚Äçüó®Ô∏è' }}
                                </button>
                            </div>
                            <small class="form-text text-muted">M√≠nimo 6 caracteres</small>
                        </div>

                        <!-- Confirmar Senha -->
                        <div class="form-group">
                            <label for="confirmarSenha">Confirmar Senha *</label>
                            <div class="input-group">
                                <input 
                                    [type]="showConfirmPassword() ? 'text' : 'password'"
                                    id="confirmarSenha"
                                    [(ngModel)]="formData.confirmarSenha" 
                                    name="confirmarSenha" 
                                    placeholder="Digite a senha novamente"
                                    required
                                    minlength="6"
                                    [disabled]="isLoading()"
                                    class="form-control">
                                <button 
                                    type="button"
                                    class="btn btn-outline-secondary"
                                    (click)="toggleConfirmPasswordVisibility()"
                                    [disabled]="isLoading()">
                                    {{ showConfirmPassword() ? 'üëÅÔ∏è' : 'üëÅÔ∏è‚Äçüó®Ô∏è' }}
                                </button>
                            </div>
                            <small class="form-text text-muted">Deve ser igual √† senha digitada acima</small>
                        </div>

                        <!-- Bot√µes -->
                        <div class="d-flex justify-content-between mt-4">
                            <button 
                                type="button" 
                                class="btn btn-secondary"
                                (click)="resetForm()"
                                [disabled]="isLoading()">
                                Limpar
                            </button>
                            
                            <button 
                                type="submit" 
                                class="btn_on-hover" 
                                [disabled]="!cadastroForm.valid || isLoading()">
                                @if (isLoading()) {
                                    <span class="spinner-border spinner-border-sm me-2" role="status" aria-hidden="true"></span>
                                    Cadastrando...
                                } @else {
                                    Cadastrar Usu√°rio
                                }
                            </button>
                        </div>
                    </form>

                    <div class="text-muted mt-3">
                        <small>* Campos obrigat√≥rios</small>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>

<app-footer></app-footer>
